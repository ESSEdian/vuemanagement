webpackJsonp([6],{DtGc:function(t,e){},UmiO:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n=a("bOdI"),s=a.n(n),o=a("mvHQ"),l=a.n(o),r=a("fZjL"),c=a.n(r),u=(a("8+FI"),a("vMJZ")),d=(a("mtWM"),a("mw3O"),{name:"dashboard",data:function(){return{list:[],users:[],project:[],table:[],user:[],userProject:[],userTable:[],search:"",restaurants:[],state3:"",userId:"",projectId:"",options:[{label:"黄金糕"},{label:"双皮奶"}],rules:{userName:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],loginName:[{required:!0,message:"请输入登录名",trigger:"blur"}]},value:"",creat:!1,form:{loginName:"",userName:"",password:"",appId:"",state:"",id:"",loginIp:"",loginTime:"",loginCount:"",createTime:"",updateTime:""},edit:{loginName:"",userName:"",password:"",appId:"",state:"",id:"",loginIp:"",loginTime:"",loginCount:"",createTime:"",updateTime:""},pageNum:1,currentPage:1,total:0,paging:{page:1,limit:10,pageNum:10},details:!1,task:!1,rowIndex:"",Permission:!1,name:localStorage.getItem("ms_username"),title:"用户详情",test1:[{name:"id",value:"202"},{name:"app_id",value:"application_1212212_32323"}],tableData:[]}},mounted:function(){this.getTask(),this.userLists(),this.projectList(),this.tableList()},computed:{tables:function(){var t=this.search;return t?this.list.filter(function(e){return c()(e).some(function(a){return String(e[a]).indexOf(t)>-1})}):this.list},handleuser:function(){var t=this.search;return t?this.user.filter(function(e){return c()(e).some(function(a){return String(e[a]).indexOf(t)>-1})}):this.user},handleproject:function(){var t=this.psearch;return t?this.userProject.filter(function(e){return c()(e).some(function(a){return String(e[a]).indexOf(t)>-1})}):this.userProject},handletable:function(){var t=this.tsearch;return t?this.userTable.filter(function(e){return c()(e).some(function(a){return String(e[a]).indexOf(t)>-1})}):this.userTable}},methods:(i={changeProject:function(t){this.multipleSelection=t;var e=this.multipleSelection.map(function(t){return t.id}),a=e.toString();console.log(e,a)},changeTable:function(t){this.tables=t;var e=this.tables.map(function(t){return t.id}),a=e.toString();console.log(e,a)},handleSelectionChange:function(t){this.selectData=t;var e=this.selectData.map(function(t){return t.id}),a=e.toString();console.log(e,a)},createFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},handleSelect:function(t){console.log(t)},handleIconClick:function(t){console.log(t)},selected:function(t){this.form.jar=t},handleSizeChange:function(t){this.paging.page=t,this.getTask()},handleCurrentChange:function(t){this.paging.pageNum=t,this.getTask()}},s()(i,"selected",function(t){this.form.jar=t}),s()(i,"establish",function(){this.creat=!0}),s()(i,"getTask",function(){var t=this;this.paging;console.log(this.paging),this.$http.get(u.u).then(function(e){console.log(e),t.total=e.data.pagination.total,t.list=e.data.data})}),s()(i,"handleEdit",function(t,e){console.log(t,e)}),s()(i,"handleDelete",function(t,e){console.log(t,e)}),s()(i,"closeTask",function(){this.task=!1,this.creat=!1}),s()(i,"closePermission",function(){this.Permission=!1}),s()(i,"tableHeaderColor",function(t){t.row,t.column;var e=t.rowIndex;t.columnIndex;if(0===e)return"background-color: #F7F6Fd;color: #999;font-weight: 700;"}),s()(i,"handleSelectionChange",function(t){this.selectData=t;var e=this.selectData.map(function(t){return t.id}),a=e.toString();console.log(e,a)}),s()(i,"rowClass",function(t){t.row;var e=t.rowIndex;if(this.selectRow.includes(e))return{"background-color":"rgba(185, 221, 249, 0.75)"}}),s()(i,"prowClass",function(t){t.row;var e=t.rowIndex;if(this.pselectRow.includes(e))return{"background-color":"rgba(185, 221, 249, 0.75)"}}),s()(i,"trowClass",function(t){t.row;var e=t.rowIndex;if(this.tselectRow.includes(e))return{"background-color":"rgba(185, 221, 249, 0.75)"}}),s()(i,"handdle",function(t,e,a){var i=this;this.multipleSelection=t,console.log(t,e,a),this.getIndex=t.rowIndex,console.log(this.userId);var n=this.userId;this.$http.get(u.w+"?userId="+n+"&projectId="+t.id).then(function(t){console.log(t.data.data),i.userTable=t.data.data}),this.projectId=t.id}),s()(i,"tableRowClassName",function(t){var e=t.row,a=t.rowIndex;e.rowIndex=a}),s()(i,"selectedHighlight",function(t){var e=t.row,a=t.rowIndex;if(console.log(e,a,this.getIndex),this.getIndex===a)return console.log("cloor"),{"background-color":"#CAE1FF"}}),s()(i,"tableList",function(){var t=this;this.$http.get(u.n).then(function(e){console.log(e),t.table=e.data.data.tableList})}),s()(i,"userLists",function(){var t=this;this.$http.get(u.a).then(function(e){console.log(e),t.users=e.data.data.userList})}),s()(i,"projectList",function(){var t=this;this.$http.get(u.l).then(function(e){console.log(e),t.project=e.data.data.projectList})}),s()(i,"open7",function(t,e){var a=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){console.log(e.id),a.$http.delete(u.r+e.id).then(function(t){console.log(t),a.$message({type:"success",message:"删除成功!"}),a.getTask()})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})}),s()(i,"deleteProject",function(t,e){var a=this;this.$confirm("此操作将删除该用户关联的店铺, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){var t=a.userId;console.log(t),console.log(e.id),console.log(u.h),a.$http.delete(u.h+t+"/"+e.id).then(function(t){console.log(t),a.$message({type:"success",message:"删除成功!"}),a.open8(a.userId)})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})}),s()(i,"deleteTable",function(t,e){var a=this;this.$confirm("此操作将删除改用户关联店铺的报表, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){var t=a.userId,i=a.projectId;console.log(e.id),a.$http.delete(u.i+t+"/"+i+"/"+e.id).then(function(t){console.log(t),a.$message({type:"success",message:"删除成功!"}),a.open8(a.userId);var e=a.userId,i=a.projectId;a.$http.get(u.w+"?userId="+e+"&projectId="+i).then(function(t){console.log(t.data.data),a.userTable=t.data.data})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})}),s()(i,"open8",function(t){var e=this;this.Permission=!0,this.$http.get(u.q+"?userId="+t).then(function(t){console.log(t.data.data),e.user=t.data.data}),this.$http.get(u.v+"?userId="+t).then(function(t){console.log(t.data.data),e.userProject=t.data.data}),this.$http.get(u.w+"?userId="+t+"&projectId=0").then(function(t){console.log(t.data.data),e.userTable=t.data.data}),this.userId=t}),s()(i,"closeMask",function(){this.details=!1}),s()(i,"open4",function(){console.log(),this.details=!0}),s()(i,"opentask",function(t){this.task=!0,this.edit.loginName=t.loginName,this.edit.password=t.password,this.edit.userName=t.userName,this.edit.id=t.id}),s()(i,"onSubmit",function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;e.$http.post(u.g,l()(e.form),{headers:{"Content-Type":"application/json"}}).then(function(t){console.log(t),e.$message(t.data.message),e.creat=!1,e.form=!1,e.getTask()},function(t){console.log(t)})})}),s()(i,"resetForm",function(t){this.$refs[form].resetFields()}),s()(i,"handleChangeEdit",function(){var t=this;console.log(this.edit),this.$http.post(u.t,l()(this.edit),{headers:{"Content-Type":"application/json"}}).then(function(e){console.log(e),t.$message(e.data.message),t.task=!1,t.edit=!1,t.getTask()},function(e){t.$message("修改失败"),console.log(error)})}),s()(i,"querySearchAsync",function(t,e){var a=this.restaurants,i=t?a.filter(this.createStateFilter(t)):a;clearTimeout(this.timeout),this.timeout=setTimeout(function(){e(i)},3e3*Math.random())}),s()(i,"createStateFilter",function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}}),s()(i,"handleSelect",function(t){console.log(t)}),i),watch:{selectData:function(t){var e=this;this.selectRow=[],t.length>0&&t.forEach(function(t,a){e.selectRow.push(e.users.indexOf(t))})},tables:function(t){var e=this;this.tselectRow=[],t.length>0&&t.forEach(function(t,a){e.tselectRow.push(e.table.indexOf(t))})},multipleSelection:function(t){var e=this;this.pselectRow=[],t.length>0&&t.forEach(function(t,a){e.pselectRow.push(e.project.indexOf(t))})}}}),h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list"},[a("div",{staticStyle:{width:"100px",height:"35px","margin-bottom":"15px","margin-right":"1200px"}},[a("el-button",{staticStyle:{width:"100px",height:"35px","margin-bottom":"15px"},attrs:{type:"primary",round:"",size:"mini"},on:{click:t.establish}},[t._v("创建用户")])],1),t._v(" "),a("div",{staticStyle:{width:"30%","margin-top":"-40px","margin-left":"500px"}},[t._v("筛选：")]),t._v(" "),a("div",{staticStyle:{width:"60%","margin-top":"-20px","margin-bottom":"35px","margin-left":"500px"}},[a("el-input",{staticStyle:{width:"40%","margin-top":"-30px"},attrs:{type:"search",placeholder:"请输入关键字"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tables.slice((t.paging.page-1)*t.paging.limit,t.paging.page*t.paging.limit),"default-sort":{prop:"username",order:"ascending"}}},[a("el-table-column",{attrs:{prop:"username",sortable:"",label:"用户名",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.userName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"登录名",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.loginName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"登录IP",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.loginIp))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"360"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.opentask(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.open8(e.row.id)}}},[t._v("修改权限")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.open7(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{layout:"total, prev, pager, next",total:t.total,"page-sizes":[10,20,30,40],"current-page":t.paging.page,"page-size":t.paging.limit},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.paging,"page",e)}}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.details,expression:"details"}],staticClass:"dialog "},[a("div",{staticClass:"dialog-container"},[a("div",{staticClass:"dialog-title"},[t._v(t._s(t.title))]),t._v(" "),a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._l(t.form,function(e){return a("div",{key:e.appId,staticClass:"headline d_content claerfix"},[a("div",{staticClass:"headline_key fl"},[t._v(t._s(e.userName))]),t._v(" "),a("div",{staticClass:"headline_value fl"},[t._v(t._s(e.loginName))])])})],2),t._v(" "),a("div",{staticClass:"close-btn",on:{click:t.closeMask}},[a("i",{staticClass:"el-icon-close"})])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.creat,expression:"creat"}],staticClass:"dialog "},[a("div",{staticClass:"dialog-container task-container"},[a("div",{staticStyle:{"font-weight":"600",color:"#607d93","background-color":"#daedf9",height:"45px","line-height":"45px"}},[t._v("创建用户")]),t._v(" "),a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[a("el-input",{staticClass:"fr",staticStyle:{width:"614px"},model:{value:t.form.userName,callback:function(e){t.$set(t.form,"userName",e)},expression:"form.userName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{staticClass:"fr",staticStyle:{width:"614px"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"邮件",prop:"loginName"}},[a("el-input",{staticClass:"fr",staticStyle:{width:"614px"},model:{value:t.form.loginName,callback:function(e){t.$set(t.form,"loginName",e)},expression:"form.loginName"}})],1),t._v(" "),a("el-form-item",[a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.onSubmit("form")}}},[t._v("确定")]),t._v(" "),a("el-button",{on:{click:t.closeTask}},[t._v("取消")])],1)])],1)],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.task,expression:"task"}],staticClass:"dialog "},[a("div",{staticClass:"dialog-container task-container"},[a("div",{staticStyle:{"font-weight":"600",color:"#607d93","background-color":"#daedf9",height:"45px","line-height":"45px"}},[t._v("修改用户信息")]),t._v(" "),a("el-form",{ref:"form",attrs:{model:t.edit,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{staticClass:"fr",staticStyle:{width:"614px"},model:{value:t.edit.userName,callback:function(e){t.$set(t.edit,"userName",e)},expression:"edit.userName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{staticClass:"fr",staticStyle:{width:"614px"},model:{value:t.edit.password,callback:function(e){t.$set(t.edit,"password",e)},expression:"edit.password"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"邮件"}},[a("el-input",{staticClass:"fr",staticStyle:{width:"614px"},model:{value:t.edit.loginName,callback:function(e){t.$set(t.edit,"loginName",e)},expression:"edit.loginName"}})],1),t._v(" "),a("el-form-item",[a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleChangeEdit}},[t._v("确定")]),t._v(" "),a("el-button",{on:{click:t.closeTask}},[t._v("取消")])],1)])],1)],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.Permission,expression:"Permission"}],staticClass:"dialogs "},[a("div",{staticClass:"dialog-container task-container"},[a("div",{staticStyle:{"font-weight":"600",color:"#607d93","background-color":"#daedf9",height:"45px","line-height":"45px"}},[t._v("修改用户权限")]),t._v(" "),a("div",{staticStyle:{"justify-content":"space-between",display:"flex","margin-top":"20px"}},[a("div",{staticClass:"user"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":t.tableHeaderColor,data:t.handleuser,height:"450"}},[a("el-table-column",{attrs:{width:"30"}}),t._v(" "),a("el-table-column",{attrs:{label:"用户",width:"320"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"text-align":"center"}},[t._v(t._s(e.row.userName))])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"userProject"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":t.tableHeaderColor,"row-class-name":t.tableRowClassName,"highlight-current-row":!0,data:t.handleproject,height:"450"},on:{"row-click":t.handdle}},[a("el-table-column",{attrs:{width:"30"}}),t._v(" "),a("el-table-column",{attrs:{label:"项目",width:"320"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"left"}},[t._v(t._s(e.row.projectName))]),t._v(" "),a("span",{staticStyle:{float:"right"}},[a("el-button",{attrs:{size:"mini",type:"danger",round:"",icon:"el-icon-delete"},on:{click:function(a){t.deleteProject(e.$index,e.row)}}})],1)]}}])})],1)],1),t._v(" "),a("div",{staticClass:"userTable"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":t.tableHeaderColor,data:t.handletable,height:"450"},on:{"selection-change":t.changeTable}},[a("el-table-column",{attrs:{width:"30"}}),t._v(" "),a("el-table-column",{attrs:{label:"报表",width:"320"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{float:"left"}},[t._v(t._s(e.row.tableName))]),t._v(" "),a("span",{staticStyle:{float:"right"}},[a("el-button",{attrs:{size:"mini",type:"danger",round:"",icon:"el-icon-delete"},on:{click:function(a){t.deleteTable(e.$index,e.row)}}})],1)]}}])})],1)],1)]),t._v(" "),a("el-button",{staticStyle:{width:"20%","margin-top":"50px"},attrs:{type:"primary"},on:{click:t.closePermission}},[t._v("退出")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"headline claerfix"},[e("div",{staticClass:"headline_key fl"},[this._v("用户名")]),this._v(" "),e("div",{staticClass:"headline_value fl"},[this._v("登录名")])])}]};var g=a("VU/8")(d,h,!1,function(t){a("DtGc")},"data-v-f3015c32",null);e.default=g.exports}});